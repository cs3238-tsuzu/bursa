# When to start the service
start on runlevel [2345]

# When to stop the service
stop on runlevel [016]

oom never
expect daemon
respawn
respawn limit 10 60 # 10 times in 60 seconds

script
# Some nasty hard coded values.
user=vagrant
home=/home/$user
pidfile=$home/bitcoind.pid
cmd=/usr/bin/bitcoind
[[ -e $pidfile && ! -d "/proc/$(cat $pidfile)" ]] && rm $pidfile
[[ -e $pidfile && "$(cat /proc/$(cat $pidfile)/cmdline)" != $cmd* ]] && rm $pidfile
exec start-stop-daemon --start -c $user --chdir $home --pidfile $pidfile --startas $cmd -b -m
end script
